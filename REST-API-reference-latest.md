# 运营管理系统 REST API 参考文档 v1.0<!-- omit in toc -->

[Postman](https://www.postman.com/itabbot/workspace/fooins/documentation/23043514-292bc3a5-5829-4318-8283-644b95fb3e3e)

## 变更说明<!-- omit in toc -->

本文档及对应的 API 是最初始版本。

## 目录<!-- omit in toc -->

- [1. 接口规范](#1-接口规范)
  - [1.1. 接口地址](#11-接口地址)
  - [1.2. 请求格式](#12-请求格式)
  - [1.3. 响应格式](#13-响应格式)
  - [1.4. 身份验证](#14-身份验证)
  - [1.5. 其他细节](#15-其他细节)
- [2. 测试接口](#2-测试接口)
  - [2.1. 测试](#21-测试)

# 1. 接口规范

## 1.1. 接口地址

所有 API 都通过 HTTPS 来访问，并以下方地址作为接口的基础地址：

| 环境 | 地址                                          |
| ---- | --------------------------------------------- |
| 生产 | https://opsmgtapi.fooins.itabbot.com/v1.0     |
| 开发 | https://dev.opsmgtapi.fooins.itabbot.com/v1.0 |

## 1.2. 请求格式

对于 POST、PUT、PATH 和 DELETE 请求，所有数据均以 JSON 格式发送和接收。客户端需使用 `Content-type` 为 `application/json` 的 HTTP 请求标头。

## 1.3. 响应格式

服务端会返回标准的 [HTTP 状态代码](#131-http-状态代码) 和一个固定格式的 JSON 数据，格式如下：

| 序  | 字段名    | 类型                      | 必需 | 说明         |
| :-: | --------- | ------------------------- | :--: | ------------ |
|  1  | `code`    | [响应代码](#132-响应代码) |  是  | 响应代码。   |
|  2  | `message` | 字符串                    |  是  | 消息。       |
|  3  | `data`    | 视具体接口而定            |  否  | 响应的数据。 |

成功示例：

```json
{
  "code": "SUCCESS",
  "message": "请求成功",
  "data": {
    "id": 1
  }
}
```

失败示例：

```json
{
  "code": "INVALID_REQUEST",
  "message": "请求的参数有误"
}
```

### 1.3.1. HTTP 状态代码<!-- omit in toc -->

| 状态代码 | 状态消息                                  | 说明                                                       |
| :------: | ----------------------------------------- | ---------------------------------------------------------- |
|   400    | 错误的请求 (Bad Request)                  | 无法处理请求，因为格式有误或者不正确。                     |
|   401    | 未经授权 (Unauthorized)                   | 资源所需的身份验证信息缺少或无效。                         |
|   403    | 禁止访问 (Forbidden)                      | 对于请求的资源，访问被拒绝。用户可能没有足够的权限。       |
|   404    | 未找到 (Not Found)                        | 所请求的资源不存在。                                       |
|   405    | 方法不允许 (Method Not Allowed)           | 请求中的 HTTP 方法在资源上不允许。                         |
|   406    | 不接受 (Not Acceptable)                   | 该服务不支持 “Accept” 标头中请求的格式。                   |
|   413    | 请求实体太大 (Request Entity Too Large)   | 请求的大小超出最大限制。                                   |
|   415    | 媒体类型不受支持 (Unsupported Media Type) | 请求的内容类型的格式不受服务支持。                         |
|   422    | 实体无法处理 (Unprocessable Entity)       | 无法处理请求，因为语义上不正确。                           |
|   429    | 请求过多 (Too Many Requests)              | 客户端应用程序已被限制，经过一段时间之后再尝试重复的请求。 |
|   500    | 内部服务器错误 (Internal Server Error)    | 处理请求时出现内部服务器错误。                             |
|   503    | 服务不可用 (Service Unavailable)          | 该服务暂时不可用。可以过段时间之后再重复该请求。           |

### 1.3.2. 响应代码<!-- omit in toc -->

客户端应做好处理其中任意一项的准备。

| 响应代码             | 说明                                             |
| -------------------- | ------------------------------------------------ |
| SUCCESS              | 请求成功。                                       |
| UNAUTHORIZED         | 客户端未经授权。                                 |
| ACCESS_DENIED        | 客户端没有执行该操作的权限。                     |
| INVALID_REQUEST      | 请求格式有误或不正确。                           |
| NOT_FOUND            | 所请求的资源不存在。                             |
| INTERNAL_SERVERERROR | 处理请求时出现服务端内部错误。                   |
| SERVICE_UNAVAILABLE  | 该服务暂时不可用。可以过段时间之后再重复该请求。 |
| GENERAL_EXCEPTION    | 发生未指定错误。                                 |

## 1.4. 身份验证

## 1.5. 其他细节

可在请求标头中通过 `FI-Request-ID` 携带请求标识，若不携带则服务端会自动生成。最终会在接口响应时通过相同名称的响应标头返回给客户端。

空值的字段会使用 `null` 值，而不是被省略。

所有时间值都以 UTC 时间（ISO 8601）格式返回：`YYYY-MM-DDTHH:MM:SSZ`。

# 2. 测试接口

## 2.1. 测试

请求方法：GET

请求路径：/test

响应数据：

| 序  | 参数名  | 类型     | 必需 | 说明                    |
| :-: | ------- | -------- | :--: | ----------------------- |
|  1  | `time`  | UTC 时间 |  是  | 接口处理时的时间。      |
|  2  | `query` | 对象     |  是  | 请求的 URL Query 参数。 |

响应数据示例：

```JSON
{
    "now": "2022-12-19T15:51:48.7516364+08:00",
    "query": {}
}
```
